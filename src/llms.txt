# Authentication API (for AI clients)

This service issues and verifies JWT access tokens.

## Purpose
- `POST /login`: exchange valid credentials for a JWT
- `POST /refresh`: exchange a valid refresh token for a new token pair
- `GET /verify`: validate a JWT and return its payload

## Contract

### `POST /login`
- Request body (JSON):
  - `username` (string)
  - `password` (string)
- Success:
  - Status: `200`
  - Body: `{ "token": "<jwt>", "accessToken": "<jwt>", "refreshToken": "<jwt>", "tokenType": "Bearer", "expiresIn": 900 }`
- Failure:
  - Status: `401`
  - Body: `{ "error": "Invalid credentials" }`

### `POST /refresh`
- Request body (JSON):
  - `refreshToken` (string)
- Success:
  - Status: `200`
  - Body: `{ "token": "<jwt>", "accessToken": "<jwt>", "refreshToken": "<jwt>", "tokenType": "Bearer", "expiresIn": 900 }`
- Failure:
  - Status: `401`
  - Body: `{ "error": "Invalid refresh token" }`

### `GET /verify`
- Required header:
  - `Authorization: Bearer <jwt>`
- Success:
  - Status: `200`
  - Body: `{ "payload": { ...jwt_claims } }`
- Failure:
  - Status: `401`

## Token Semantics
- Token type: JWT
- Signed with server secret
- Includes `iat` and `exp`
- Access token TTL: 15 minutes from issuance
- Refresh token TTL: 7 days from issuance

## Client Expectations
- Treat `401` as authentication failure or expired token
- On access token expiry, obtain a new token via `POST /refresh`
- If refresh fails, obtain a new token via `POST /login`
- Do not expose or log raw credentials
- Send tokens only over HTTPS in production
